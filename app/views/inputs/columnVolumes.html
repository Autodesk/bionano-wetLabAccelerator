<input type="checkbox"
       ng-init="showColumnVolumes = true"
       ng-model="showColumnVolumes"> Show Column Volumes

<div ng-show="showColumnVolumes"
     ng-controller="columnVolumesCtrl as colvolCtrl"
     ng-init="colvolCtrl.groups = fieldCtrl.model">

  <tx-plate-columns group-data="fieldCtrl.model"
                    on-click="colvolCtrl.handleColumnSelection($column)"></tx-plate-columns>

  <table>
    <tr ng-repeat="group in colvolCtrl.groups"
        class="columnVolumes-group"
        ng-class="{'active' : colvolCtrl.colvolActive == $index}"
        ng-click="colvolCtrl.activateGroup($index)">
      <td ng-style="{color: group.color}">&block;</td>
      <!--<td><input type="text"
                 class="input-unstyled"
                 ng-list
                 ng-model="group.columns"></td>-->
      <td><span ng-repeat="col in group.columns" ng-bind="col + ($last ? '' : ', ')"></span></td>
      <td>
        <tx-protocol-field ng-model="group.volume"
                           prevent-variable="true"
                           field="{type: 'volume'}">
        </tx-protocol-field>
      </td>
    </tr>
  </table>
</div>

<div ng-hide="showColumnVolumes">
  <div ng-repeat="colvol in fieldCtrl.model">
    <table>
      <tr>
        <td class="operation-label">columns (comma-sep, 0-indexed)</td>
        <td>
          <input type="text"
                 ng-list
                 ng-model="colvol.columns">
        </td>
      </tr>
      <tr>
        <td class="operation-label">volume</td>
        <td>
          <tx-protocol-field ng-model="colvol.volume"
                             field="{type: 'volume'}">
          </tx-protocol-field>
        </td>
      </tr>
    </table>

  </div>
  <button ng-click="fieldCtrl.model.length ? fieldCtrl.model.push({}) : fieldCtrl.model = [{}]">Add Column</button>
</div>